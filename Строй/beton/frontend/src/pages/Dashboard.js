import { jsx as _jsx, jsxs as _jsxs } from "react/jsx-runtime";
import { useQuery } from '@tanstack/react-query';
import apiClient from '../api/client';
import { format } from 'date-fns';
const Dashboard = () => {
    const { data, isLoading } = useQuery({
        queryKey: ['dashboard'],
        queryFn: async () => {
            const response = await apiClient.get('/monitoring/dashboard');
            return response.data;
        },
        refetchInterval: 5000, // Обновление каждые 5 секунд
    });
    if (isLoading) {
        return _jsx("div", { className: "text-center py-8", children: "\u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430..." });
    }
    return (_jsxs("div", { className: "px-4 py-6", children: [_jsx("h1", { className: "text-2xl font-bold text-gray-900 mb-6", children: "\u0414\u0430\u0448\u0431\u043E\u0440\u0434" }), _jsxs("div", { className: "grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4 mb-8", children: [_jsx("div", { className: "bg-white overflow-hidden shadow rounded-lg", children: _jsx("div", { className: "p-5", children: _jsxs("div", { className: "flex items-center", children: [_jsx("div", { className: "flex-shrink-0", children: _jsx("div", { className: "text-2xl font-bold text-gray-900", children: data?.active_batches || 0 }) }), _jsx("div", { className: "ml-5 w-0 flex-1", children: _jsx("dl", { children: _jsx("dt", { className: "text-sm font-medium text-gray-500 truncate", children: "\u0410\u043A\u0442\u0438\u0432\u043D\u044B\u0445 \u043F\u0430\u0440\u0442\u0438\u0439" }) }) })] }) }) }), _jsx("div", { className: "bg-white overflow-hidden shadow rounded-lg", children: _jsx("div", { className: "p-5", children: _jsxs("div", { className: "flex items-center", children: [_jsx("div", { className: "flex-shrink-0", children: _jsx("div", { className: "text-2xl font-bold text-gray-900", children: data?.pending_orders || 0 }) }), _jsx("div", { className: "ml-5 w-0 flex-1", children: _jsx("dl", { children: _jsx("dt", { className: "text-sm font-medium text-gray-500 truncate", children: "\u041E\u0436\u0438\u0434\u0430\u044E\u0449\u0438\u0445 \u0437\u0430\u043A\u0430\u0437\u043E\u0432" }) }) })] }) }) }), _jsx("div", { className: "bg-white overflow-hidden shadow rounded-lg", children: _jsx("div", { className: "p-5", children: _jsxs("div", { className: "flex items-center", children: [_jsx("div", { className: "flex-shrink-0", children: _jsxs("div", { className: "text-2xl font-bold text-gray-900", children: [data?.equipment_status?.filter((e) => e.is_operational).length || 0, "/", data?.equipment_status?.length || 0] }) }), _jsx("div", { className: "ml-5 w-0 flex-1", children: _jsx("dl", { children: _jsx("dt", { className: "text-sm font-medium text-gray-500 truncate", children: "\u041E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u0435 \u0440\u0430\u0431\u043E\u0442\u0430\u0435\u0442" }) }) })] }) }) }), _jsx("div", { className: "bg-white overflow-hidden shadow rounded-lg", children: _jsx("div", { className: "p-5", children: _jsxs("div", { className: "flex items-center", children: [_jsx("div", { className: "flex-shrink-0", children: _jsx("div", { className: "text-2xl font-bold text-red-600", children: data?.low_stock_materials?.length || 0 }) }), _jsx("div", { className: "ml-5 w-0 flex-1", children: _jsx("dl", { children: _jsx("dt", { className: "text-sm font-medium text-gray-500 truncate", children: "\u041D\u0438\u0437\u043A\u0438\u0439 \u043E\u0441\u0442\u0430\u0442\u043E\u043A" }) }) })] }) }) })] }), _jsxs("div", { className: "grid grid-cols-1 gap-5 lg:grid-cols-2", children: [_jsx("div", { className: "bg-white shadow rounded-lg", children: _jsxs("div", { className: "px-4 py-5 sm:p-6", children: [_jsx("h3", { className: "text-lg leading-6 font-medium text-gray-900 mb-4", children: "\u0421\u0442\u0430\u0442\u0443\u0441 \u043E\u0431\u043E\u0440\u0443\u0434\u043E\u0432\u0430\u043D\u0438\u044F" }), _jsx("div", { className: "space-y-3", children: data?.equipment_status?.map((equipment) => (_jsxs("div", { className: "flex items-center justify-between p-3 bg-gray-50 rounded", children: [_jsxs("div", { children: [_jsx("div", { className: "font-medium text-gray-900", children: equipment.equipment_name }), _jsx("div", { className: "text-sm text-gray-500", children: equipment.equipment_type })] }), _jsx("div", { className: "flex items-center", children: _jsx("span", { className: `px-2 py-1 text-xs font-semibold rounded-full ${equipment.is_operational
                                                        ? 'bg-green-100 text-green-800'
                                                        : 'bg-red-100 text-red-800'}`, children: equipment.status }) })] }, equipment.id))) })] }) }), _jsx("div", { className: "bg-white shadow rounded-lg", children: _jsxs("div", { className: "px-4 py-5 sm:p-6", children: [_jsx("h3", { className: "text-lg leading-6 font-medium text-gray-900 mb-4", children: "\u041F\u043E\u0441\u043B\u0435\u0434\u043D\u0438\u0435 \u043F\u0430\u0440\u0442\u0438\u0438" }), _jsx("div", { className: "space-y-3", children: data?.recent_batches?.slice(0, 10).map((batch) => (_jsxs("div", { className: "flex items-center justify-between p-3 bg-gray-50 rounded", children: [_jsxs("div", { children: [_jsx("div", { className: "font-medium text-gray-900", children: batch.batch_number }), _jsx("div", { className: "text-sm text-gray-500", children: format(new Date(batch.created_at), 'dd.MM.yyyy HH:mm') })] }), _jsx("span", { className: `px-2 py-1 text-xs font-semibold rounded-full ${batch.status === 'completed'
                                                    ? 'bg-green-100 text-green-800'
                                                    : batch.status === 'error'
                                                        ? 'bg-red-100 text-red-800'
                                                        : 'bg-yellow-100 text-yellow-800'}`, children: batch.status })] }, batch.id))) })] }) })] })] }));
};
export default Dashboard;
